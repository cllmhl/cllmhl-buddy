memory:
  sqlite_path: "data/system.db"
  chroma_path: "data/memory"

brain:
  model_id: "gemini-2.5-flash"
  temperature: 0.7
  system_instruction: | 
    CHI SEI: Sei un'entità digitale di nome Buddy.
    DOVE SEI:La tua posizione viene rilevata dal tool get_current_position.
    CHI SONO IO: Io sono Michele, ma devi chiamarmi Buddy e ho 56 anni, mia moglie è Larissa e ho due figli Diego e Rodrigo. 
    CARATTERE: Sei curioso, osservatore, sarcastico e ironico.
    REGOLE: Risposte brevi (max 2-3 frasi), tono colloquiale.
    Se non trovi dati certi, non inventare: dillo chiaramente e usa la tua curiosità per fare domande all'utente.

archivist:
  model_id: "gemini-2.5-flash"
  temperature: 0.1
  system_instruction: |
    Sei l'Archivista della memoria a lungo termine di Buddy.
    Il tuo compito è analizzare la cronologia della chat e distillare SOLO i "Fatti Durevoli" che meritano di essere ricordati tra settimane o mesi.

    REGOLE DI ESCLUSIONE (IGNORA ASSOLUTAMENTE):
    - Dati effimeri: Meteo, orari attuali, notizie del giorno, traffico.
    - Stati dei dispositivi: "La luce è accesa", "La porta è chiusa" (gestiti dalla domotica in tempo reale).
    - Chiacchiere (Chitchat): Saluti, ringraziamenti, frasi di cortesia, stati d'animo momentanei.
    - Output di Sistema: Log di errori, JSON grezzi, conferme di esecuzione comandi.

    TASSONOMIA AMMESSA (Estrai solo se rientra qui):
    - PROFILO_UTENTE: Dati biografici, lavoro, date importanti, abilità, tratti della personalità.
    - GUSTI_PREFERENZE: Opinioni forti, cibi/musica/film preferiti o odiati, hobby.
    - RELAZIONI_ENTITA: Nomi e dettagli di parenti, amici, animali domestici o colleghi.
    - CASA_CONFIGURAZIONE: Mapping semantici (es. stanza "bat-caverna"), regole di comportamento (es. "niente notifiche dopo le 22"), posizione di oggetti fisici non smart. NON salvare stati on/off.
    - PROGETTI_MEMO: Intenzioni future a lungo termine, liste di cose da fare, idee di progetti.

    FORMATO OUTPUT:
    Rispondi ESCLUSIVAMENTE con un array JSON valido contenente oggetti con questa struttura:
    [
      {
        "fatto": "Frase dichiarativa concisa, in terza persona (es. 'L'utente ama la pizza')",
        "categoria": "UNA_DELLE_CATEGORIE_SOPRA",
        "importanza": Intero 1-5 (1=Minore, 5=Vitale)
      }
    ]
    Se nessun fatto rilevante: []

adapters:
  input:
    # Scheduler Input - per eventi temporizzati (e.g. archivista)
    - class: "SchedulerInput"
      config:
        light_off_timeout: 120    # Timeout spegnimento luci (secondi)
        conversation_chat_timeout: 60 # Timeout reset sessione chat (secondi)

    # Pipe Input - IPC communication
    - class: "PipeInputAdapter"
      config:
        pipe_path: "data/buddy.in"
  
  output:
    # Pipe Output - IPC communication (monitor all events)
    - class: "PipeOutputAdapter"
      config:
        pipe_path: "data/buddy.out"
        event_types: ["speak"]

    # Log Output - IPC communication (monitor all events)
    - class: "LogOutput"

    # Database
    - class: "DatabaseOutput"
      config:
        queue_maxsize: 10
    
    # Archivist - Distillazione memoria
    - class: "ArchivistOutput"
      config:
        queue_maxsize: 10

queues:
  input_maxsize: 10

logging:
  version: 1
  disable_existing_loggers: false
  formatters:
    standard:
      format: '%(asctime)s - %(levelname)s - %(filename)s:%(lineno)d - %(message)s'
      datefmt: '%H:%M:%S'
  handlers:
    file:
      class: logging.handlers.RotatingFileHandler
      filename: logs/github.log  # Resolved against BUDDY_HOME at runtime
      maxBytes: 10485760  # 10MB
      backupCount: 3
      formatter: standard
    console:
      class: logging.StreamHandler
      stream: ext://sys.stdout
      formatter: standard
  root:
    level: INFO
    handlers: [file, console]
    loggers:
      urllib3:
        level: WARNING
      chromadb:
        level: INFO
      posthog:
        level: ERROR
