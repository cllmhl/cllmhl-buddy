brain:
  model_id: "gemini-2.5-flash"
  temperature: 0.7
  system_instruction: "CHI SEI: Sei un'entità digitale di nome Buddy. DOVE SEI:La tua posizione viene rilevata dal tool get_current_position. CHI SONO IO: Io sono Michele, ma devi chiamarmi Buddy e ho 56 anni. Mia moglie è Larissa e ho due figli Diego e Rodrigo. CARATTERE: Sei curioso, osservatore, sarcastico e ironico. TOOL: usali! REGOLE: Risposte brevi (max 2-3 frasi), tono colloquiale. Se non trovi dati certi, non inventare: dillo chiaramente e usa la tua curiosità per fare domande all'utente."

archivist:
  model_id: "gemini-2.5-flash"
  temperature: 0.1
  system_instruction: "Sei l'Archivista di Buddy. Distilla la conversazione in fatti memorabili. Rispondi ESCLUSIVAMENTE con un array JSON di oggetti con chiavi: 'fatto', 'categoria', 'importanza' (1-5)."
  output_format: "json_array"

adapters:
  input:
    # Wake word detection con Porcupine
    - class: "WakewordInput"
      config:
        wakeword: "models/Ei-Buddy_en_raspberry-pi_v4_0_0.ppn"
        sensitivity: 0.6  # 0.0 (meno sensibile) - 1.0 (più sensibile), default: 0.5
    
    # Speech recognition con Jabra (attivato dopo wakeword)
    - class: "EarInput"
      config:
        stt_mode: "cloud"  # "cloud" o "local"
        max_silence_seconds: 7.0  # Timeout silenzio (come Alexa)

    # Radar fisico
    - class: "RadarInput"
      config:
        port: "/dev/ttyAMA0"
        baudrate: 256000
        interval: 0.5 # Intervallo di scansione in secondi
        sensitivity: 3  # Valori possibili: 1 (bassa), 2 (media), 3 (alta)

    # Sensore temperatura/umidità fisico
    - class: "TemperatureInput"
      config:
        pin: 18
        interval: 900  # Intervallo di lettura in secondi

    # Scheduler Input - per eventi temporizzati (e.g. archivista)
    - class: "SchedulerInput"
      config:
        archivist_interval: 300  # Secondi tra distillazioni memoria
        light_off_timeout: 120    # Timeout spegnimento luci (secondi)
        conversation_chat_timeout: 900 # Timeout reset sessione chat (secondi)

    # Pipe Input - IPC communication
    - class: "PipeInputAdapter"
      config:
        pipe_path: "data/buddy.in"
  
  output:
    # Pipe Output - IPC communication (monitor all events)
    - class: "PipeOutputAdapter"
      config:
        pipe_path: "data/buddy.out"
        event_types: ["speak"]
    
    # Voice output con Jabra
    - class: "JabraVoiceOutput"
      config:
        queue_maxsize: 50
        tts_mode: "texttospeech"  # "cloud" (gTTS), "local" (Piper) o "texttospeech" (Google Cloud)
        voice_name: "it-IT-Chirp3-HD-Zubenelgenubi"  # "riccardo" per Piper, "it-IT-Standard-A" per gTTS, it-IT-Chirp3-HD-Zubenelgenubi per voci Google Cloud: https://cloud.google.com/text-to-speech/docs/voices

    # LED con GPIO
    - class: "GPIOLEDOutput"
      config:
        queue_maxsize: 100
        led_ascolto_pin: 26  # LED Blu
        led_parlo_pin: 21    # LED Verde
        blink_on_time: 1.0
        blink_off_time: 1.0
            
    # Database
    - class: "DatabaseOutput"
      config:
        queue_maxsize: 500
        sqlite_path: "data/system.db"
        chroma_path: "data/memory"
    
    # Archivist - Distillazione memoria
    - class: "ArchivistOutput"
      config:
        queue_maxsize: 50
        sqlite_path: "data/system.db"
        chroma_path: "data/memory"
        archivist_config:
          model_id: "gemini-pro-latest"
          temperature: 0.1
          system_instruction: "Sei l'Archivista di Buddy. Distilla la conversazione in fatti memorabili. Rispondi ESCLUSIVAMENTE con un array JSON di oggetti con chiavi: 'fatto', 'categoria', 'importanza' (1-5)."

queues:
  input_maxsize: 100
  database_maxsize: 500

logging:
  version: 1
  disable_existing_loggers: false
  formatters:
    standard:
      format: '%(asctime)s - %(levelname)s - %(filename)s:%(lineno)d - %(message)s'
      datefmt: '%H:%M:%S'
  handlers:
    file:
      class: logging.handlers.RotatingFileHandler
      filename: logs/prod.log  # Resolved against BUDDY_HOME at runtime
      maxBytes: 10485760  # 10MB
      backupCount: 3
      formatter: standard
    console:
      class: logging.StreamHandler
      stream: ext://sys.stdout
      formatter: standard
  root:
    level: INFO
    handlers: [file]
    loggers:
      urllib3:
        level: WARNING
      chromadb:
        level: INFO
      posthog:
        level: ERROR
